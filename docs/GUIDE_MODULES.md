# –ì–∞–π–¥ –ø–æ –º–æ–¥—É–ª—è–º ¬´–†–µ—à–∞–ª—ã¬ª: –∫–∞–∫ –ø–∏—Å–∞—Ç—å –∏ –∫–∞–∫ –≤—Å—Ç—Ä–∞–∏–≤–∞—Ç—å

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–±—ä—è—Å–Ω—è–µ—Ç –≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –º–æ–¥—É–ª–µ–π –∏ –∫–∞–∫ –æ–Ω–∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É—é—Ç—Å—è –≤ –º–µ–Ω—é.

**–í—Å–µ "–∂–µ–ª–µ–∑–Ω—ã–µ" —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∫–æ–¥–∞, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è UI-—Ö–µ–ª–ø–µ—Ä–æ–≤ –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å —Å–∏—Å—Ç–µ–º–æ–π –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç:**

**‚û°Ô∏è [`STYLE_GUIDE.md`](STYLE_GUIDE.md)**

–ü–µ—Ä–µ–¥ —á—Ç–µ–Ω–∏–µ–º —ç—Ç–æ–≥–æ –≥–∞–π–¥–∞ **–Ω–∞—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è** –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å–æ `STYLE_GUIDE.md`.

---

## 1. –ì–¥–µ –∂–∏–≤—É—Ç –º–æ–¥—É–ª–∏ –∏ –∫–∞–∫ –æ–Ω–∏ –ø–æ–¥–∫–ª—é—á–∞—é—Ç—Å—è

- –í—Å–µ –º–æ–¥—É–ª–∏ –ª–µ–∂–∞—Ç –≤ –∫–∞—Ç–∞–ª–æ–≥–µ `modules/`, —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ –ø–æ–¥–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è–º:
  - `modules/core/` ‚Äî —è–¥—Ä–æ —Å–∏—Å—Ç–µ–º—ã
  - `modules/local/` ‚Äî –ª–æ–∫–∞–ª—å–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
  - `modules/security/` ‚Äî –º–æ–¥—É–ª–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
  - –∏ —Ç.–¥.
- –ì–ª–∞–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç `reshala.sh` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é-—Ä–æ—É—Ç–µ—Ä:
  - `run_module <module_path> <function> [args...]`
  - –æ–Ω–∞ –¥–µ–ª–∞–µ—Ç `source` —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –º–æ–¥—É–ª—è –∏ –≤—ã–∑—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é.
- –õ—é–±–æ–π –º–æ–¥—É–ª—å **–æ–±—è–∑–∞–Ω** —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—Ç—å –Ω–∞ —Ç–æ, —á—Ç–æ –ø–µ—Ä–µ–¥ –µ–≥–æ –≤—ã–∑–æ–≤–æ–º —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã:
  - `config/reshala.conf` (–≥–ª–æ–±–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã);
  - `modules/core/common.sh` (—Ü–≤–µ—Ç–∞, —Ö–µ–ª–ø–µ—Ä—ã –º–µ–Ω—é, `run_cmd`, `safe_read`, `ask_yes_no` –∏ —Ç.–¥.).

**–ù–∏–∫–æ–≥–¥–∞** –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ–º –º–æ–¥—É–ª–∏ –Ω–∞–ø—Ä—è–º—É—é (`bash modules/local/my_feature.sh`) ‚Äî —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ `run_module`.

---

## 2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –º–æ–¥—É–ª—è –≤ –º–µ–Ω—é: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ ¬´–ú–∞–Ω–∏—Ñ–µ—Å—Ç –º–µ–Ω—é¬ª

–í ¬´–†–µ—à–∞–ª–µ¬ª –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **–ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –º–µ–Ω—é**, –æ—Å–Ω–æ–≤–∞–Ω–Ω–∞—è –Ω–∞ "–º–∞–Ω–∏—Ñ–µ—Å—Ç–∞—Ö". –í–∞–º –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã, —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –ø—É–Ω–∫—Ç –≤ –º–µ–Ω—é.

–ü—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤—å—Ç–µ –≤ –Ω–∞—á–∞–ª–æ –≤–∞—à–µ–≥–æ `.sh` —Ñ–∞–π–ª–∞ –º–æ–¥—É–ª—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –±–ª–æ–∫-–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π `@menu.manifest`, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –æ–¥–∏–Ω –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—É–Ω–∫—Ç–æ–≤ `@item`:

```bash
#
# @menu.manifest
#
# @item( main | 4 | üíø Remnawave | show_remnawave_menu | 40 | 40 | –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ )
#
```

### –§–æ—Ä–º–∞—Ç `@item`

–ö–∞–∂–¥—ã–π –ø—É–Ω–∫—Ç –º–µ–Ω—é –æ–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–æ–π —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ 7 –ø–æ–ª—è–º–∏, —Ä–∞–∑–¥–µ–ª–µ–Ω–Ω—ã–º–∏ `|`:

`@item( PARENT | KEY | TITLE | FUNCTION | ORDER | GROUP | DESCRIPTION )`

1.  **PARENT**: ID —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –º–µ–Ω—é. `main` –¥–ª—è –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é, –∏–ª–∏ ID –¥—Ä—É–≥–æ–≥–æ –º–µ–Ω—é –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–¥–º–µ–Ω—é.
2.  **KEY**: –ö–ª–∞–≤–∏—à–∞ –¥–ª—è –≤—ã–∑–æ–≤–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `4` –∏–ª–∏ `s`).
3.  **TITLE**: –ù–∞–∑–≤–∞–Ω–∏–µ –ø—É–Ω–∫—Ç–∞ –º–µ–Ω—é, –∫–æ—Ç–æ—Ä–æ–µ —É–≤–∏–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å. –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ü–≤–µ—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `${C_BLUE}–ò–º—è`).
4.  **FUNCTION**: –ò–º—è —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –≤–∞—à–µ–º –º–æ–¥—É–ª–µ, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω–∞.
5.  **ORDER**: –ß–∏—Å–ª–æ –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –ø—É–Ω–∫—Ç–æ–≤ (—á–µ–º –º–µ–Ω—å—à–µ, —Ç–µ–º –≤—ã—à–µ).
6.  **GROUP**: –ß–∏—Å–ª–æ –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–π –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏. –ü—É–Ω–∫—Ç—ã —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º `GROUP` –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤–º–µ—Å—Ç–µ, –±–µ–∑ –ø—É—Å—Ç–æ–π —Å—Ç—Ä–æ–∫–∏ –º–µ–∂–¥—É –Ω–∏–º–∏.
7.  **DESCRIPTION**: (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –≤—ã–≤–æ–¥–∏—Ç—Å—è –ø–æ–¥ –Ω–∞–∑–≤–∞–Ω–∏–µ–º –ø—É–Ω–∫—Ç–∞.

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ `reshala.sh` —Å–∫—Ä–∏–ø—Ç `modules/core/menu_generator.sh` —Å–∫–∞–Ω–∏—Ä—É–µ—Ç –≤—Å–µ –º–æ–¥—É–ª–∏, –Ω–∞—Ö–æ–¥–∏—Ç —ç—Ç–∏ –º–∞–Ω–∏—Ñ–µ—Å—Ç—ã –∏ —Å–∞–º —Å—Ç—Ä–æ–∏—Ç –≤—Å–µ –º–µ–Ω—é –≤ –ø–∞–º—è—Ç–∏.

---

## 3. –ö–∞—Ä–∫–∞—Å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –º–æ–¥—É–ª—è

–í –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ –º–æ–¥—É–ª—å, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ—Å—Ç–æ *–æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç* –ø–æ–¥–º–µ–Ω—é, –ø—Ä–µ–¥–µ–ª—å–Ω–æ –ø—Ä–æ—Å—Ç. –ï–º—É –Ω–µ –Ω—É–∂–Ω–æ —Å–∞–º–æ–º—É —Ä–µ–Ω–¥–µ—Ä–∏—Ç—å –ø—É–Ω–∫—Ç—ã.

```bash
#!/bin/bash
# ============================================================ #
# ==                 –ú–û–î–£–õ–¨ "–ú–û–Ø –§–ò–ß–ê"                      == #
# ============================================================ #
#
# @menu.manifest
# @item( main | x | –ú–æ—è –Ω–æ–≤–∞—è —Ñ–∏—á–∞ | show_my_feature_menu | 55 | 50 | –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –º–æ–¥—É–ª—è )
# @item( my_feature | 1 | –°–¥–µ–ª–∞—Ç—å —á—Ç–æ-—Ç–æ | _my_feature_do_something | 10 | 10 | )
# @item( my_feature | 2 | –°–¥–µ–ª–∞—Ç—å –æ–ø–∞—Å–Ω–æ–µ | _my_feature_ask_danger | 20 | 10 | )
#
[[ "${BASH_SOURCE[0]}" == "${0}" ]] && exit 1 # –ó–∞—â–∏—Ç–∞ –æ—Ç –ø—Ä—è–º–æ–≥–æ –∑–∞–ø—É—Å–∫–∞

# === –õ–û–ö–ê–õ–¨–ù–´–ï –•–ï–õ–ü–ï–†–´ (private-—Ñ—É–Ω–∫—Ü–∏–∏) =====================

_my_feature_do_something() {
    ok "–°–¥–µ–ª–∞–Ω–æ!"
    wait_for_enter
}

_my_feature_ask_danger() {
    if ! ask_yes_no "–≠—Ç–æ –æ–ø–∞—Å–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ. –í—ã —É–≤–µ—Ä–µ–Ω—ã?"; then
        info "–û—Ç–º–µ–Ω–µ–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º."
        wait_for_enter
        return
    fi
    err "–ë–£–ú! (—à—É—Ç–∫–∞)"
    wait_for_enter
}


# === –ì–õ–ê–í–ù–û–ï –ú–ï–ù–Æ –ú–û–î–£–õ–Ø =====================================

show_my_feature_menu() {
    # –≠—Ç–æ –º–µ–Ω—é —è–≤–ª—è–µ—Ç—Å—è "—Ä–æ–¥–∏—Ç–µ–ª–µ–º" –¥–ª—è –¥—Ä—É–≥–∏—Ö –ø—É–Ω–∫—Ç–æ–≤.
    # –ï–≥–æ ID –¥–ª—è PARENT –≤ –¥—Ä—É–≥–∏—Ö –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞—Ö –±—É–¥–µ—Ç "my_feature".
    local menu_id="my_feature" 
    
    enable_graceful_ctrlc
    while true; do
        clear
        menu_header "üéâ –ú–æ—è –Ω–æ–≤–∞—è —Ñ–∏—á–∞"
        printf_description "–≠—Ç–æ –º–µ–Ω—é –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç render_menu_items."

        # –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–∞–º –Ω–∞–π–¥–µ—Ç –∏ –æ—Ç—Ä–∏—Å—É–µ—Ç –≤—Å–µ –ø—É–Ω–∫—Ç—ã,
        # —É –∫–æ—Ç–æ—Ä—ã—Ö –≤ –º–∞–Ω–∏—Ñ–µ—Å—Ç–µ —É–∫–∞–∑–∞–Ω–æ @item( my_feature | ... )
        render_menu_items "$menu_id"

        printf_menu_option "b" "–ù–∞–∑–∞–¥"

        local choice
        choice=$(safe_read "–í–∞—à –≤—ã–±–æ—Ä: ") || break
        
        if [[ "$choice" == "b" || "$choice" == "B" ]]; then
            break
        fi

        # –ü–æ–ª—É—á–∞–µ–º –∏ –≤—ã–ø–æ–ª–Ω—è–µ–º –¥–µ–π—Å—Ç–≤–∏–µ, —Å–≤—è–∑–∞–Ω–Ω–æ–µ —Å –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–ª–∞–≤–∏—à–µ–π
        local action
        action=$(get_menu_action "$menu_id" "$choice")
        
        if [[ -n "$action" ]]; then
            eval "$action"
        else
            printf_error "–ù–µ—Ç —Ç–∞–∫–æ–≥–æ –ø—É–Ω–∫—Ç–∞." && sleep 1
        fi
    done
    disable_graceful_ctrlc
}
```