# –ì–∞–π–¥ –ø–æ –º–æ–¥—É–ª—è–º ¬´–†–µ—à–∞–ª—ã¬ª: –∫–∞–∫ –ø–∏—Å–∞—Ç—å –∏ –∫–∞–∫ –≤—Å—Ç—Ä–∞–∏–≤–∞—Ç—å

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–±—ä—è—Å–Ω—è–µ—Ç –≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –º–æ–¥—É–ª–µ–π –∏ –∫–∞–∫ –æ–Ω–∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É—é—Ç—Å—è –≤ –º–µ–Ω—é.

**–í—Å–µ "–∂–µ–ª–µ–∑–Ω—ã–µ" —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∫–æ–¥–∞, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è UI-—Ö–µ–ª–ø–µ—Ä–æ–≤ –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å —Å–∏—Å—Ç–µ–º–æ–π –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç:**

**‚û°Ô∏è [`STYLE_GUIDE.md`](STYLE_GUIDE.md)**

–ü–µ—Ä–µ–¥ —á—Ç–µ–Ω–∏–µ–º —ç—Ç–æ–≥–æ –≥–∞–π–¥–∞ **–Ω–∞—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è** –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å–æ `STYLE_GUIDE.md`.

---

## 1. –ì–¥–µ –∂–∏–≤—É—Ç –º–æ–¥—É–ª–∏ –∏ –∫–∞–∫ –æ–Ω–∏ –ø–æ–¥–∫–ª—é—á–∞—é—Ç—Å—è

- –í—Å–µ –º–æ–¥—É–ª–∏ –ª–µ–∂–∞—Ç –≤ –∫–∞—Ç–∞–ª–æ–≥–µ `modules/`, —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ –ø–æ–¥–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è–º:
  - `modules/core/` ‚Äî —è–¥—Ä–æ —Å–∏—Å—Ç–µ–º—ã
  - `modules/local/` ‚Äî –ª–æ–∫–∞–ª—å–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
  - `modules/security/` ‚Äî –º–æ–¥—É–ª–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
  - –∏ —Ç.–¥.
- –ì–ª–∞–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç `reshala.sh` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é-—Ä–æ—É—Ç–µ—Ä:
  - `run_module <module_path> <function> [args...]`
  - –æ–Ω–∞ –¥–µ–ª–∞–µ—Ç `source` —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –º–æ–¥—É–ª—è –∏ –≤—ã–∑—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é.
- –õ—é–±–æ–π –º–æ–¥—É–ª—å **–æ–±—è–∑–∞–Ω** —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—Ç—å –Ω–∞ —Ç–æ, —á—Ç–æ –ø–µ—Ä–µ–¥ –µ–≥–æ –≤—ã–∑–æ–≤–æ–º —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã:
  - `config/reshala.conf` (–≥–ª–æ–±–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã);
  - `modules/core/common.sh` (—Ü–≤–µ—Ç–∞, —Ö–µ–ª–ø–µ—Ä—ã –º–µ–Ω—é, `run_cmd`, `safe_read`, `ask_yes_no` –∏ —Ç.–¥.).

**–ù–∏–∫–æ–≥–¥–∞** –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ–º –º–æ–¥—É–ª–∏ –Ω–∞–ø—Ä—è–º—É—é (`bash modules/local/my_feature.sh`) ‚Äî —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ `run_module`.

---

## 2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –º–æ–¥—É–ª—è –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é: –ú–∞–≥–∏—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö

–í ¬´–†–µ—à–∞–ª–µ¬ª –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –º–µ–Ω—é**. –í–∞–º –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å `reshala.sh`, —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –ø—É–Ω–∫—Ç.

–ü—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤—å—Ç–µ –≤ –Ω–∞—á–∞–ª–æ –≤–∞—à–µ–≥–æ `.sh` —Ñ–∞–π–ª–∞ –º–æ–¥—É–ª—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –±–ª–æ–∫ —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏:

```bash
# MENU_PARENT: main
# MENU_ORDER: 20
# MENU_GROUP_ID: 1
# MENU_TITLE: –ú–æ–π –º–æ–¥—É–ª—å
# MENU_KEY: m
# MENU_ENTRY: show_my_menu
```

- **`MENU_PARENT: main`** ‚Äî –£–∫–∞–∑—ã–≤–∞–µ—Ç, –≤ –∫–∞–∫–æ–µ –º–µ–Ω—é –¥–æ–±–∞–≤–ª—è—Ç—å –ø—É–Ω–∫—Ç. `main` ‚Äî —ç—Ç–æ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é.
- **`MENU_ORDER: 20`** ‚Äî –ü–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä –¥–ª—è **—Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏** –≤—Å–µ—Ö –ø—É–Ω–∫—Ç–æ–≤ –º–µ–Ω—é.
- **`MENU_GROUP_ID: 1`** ‚Äî (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) ID –≤–∏–∑—É–∞–ª—å–Ω–æ–π –≥—Ä—É–ø–ø—ã. –ü—É–Ω–∫—Ç—ã —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º `MENU_GROUP_ID` –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è **–≤–º–µ—Å—Ç–µ, –±–µ–∑ –ø—É—Å—Ç–æ–π —Å—Ç—Ä–æ–∫–∏ –º–µ–∂–¥—É –Ω–∏–º–∏**. –ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω, —Ä–∞–≤–µ–Ω –∑–Ω–∞—á–µ–Ω–∏—é `MENU_ORDER`.
- **`MENU_TITLE: –ú–æ–π –º–æ–¥—É–ª—å`** ‚Äî –¢–µ–∫—Å—Ç, –∫–æ—Ç–æ—Ä—ã–π —É–≤–∏–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ –º–µ–Ω—é. –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ü–≤–µ—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `${C_GREEN}–ó–∞–≥–æ–ª–æ–≤–æ–∫`).
- **`MENU_KEY: m`** ‚Äî –ö–ª–∞–≤–∏—à–∞ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –≤—ã–∑–æ–≤–∞.
- **`MENU_ENTRY: show_my_menu`** ‚Äî –ò–º—è —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –≤–∞—à–µ–º –º–æ–¥—É–ª–µ, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω–∞ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ —ç—Ç–æ–≥–æ –ø—É–Ω–∫—Ç–∞.

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ `reshala.sh` —Å–∫—Ä–∏–ø—Ç `modules/core/menu_generator.sh` —Å–∫–∞–Ω–∏—Ä—É–µ—Ç –≤—Å–µ –º–æ–¥—É–ª–∏, –Ω–∞—Ö–æ–¥–∏—Ç —ç—Ç–∏ –±–ª–æ–∫–∏ –∏ —Å–∞–º —Å—Ç—Ä–æ–∏—Ç –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é.

---

## 3. –ö–∞—Ä–∫–∞—Å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –º–æ–¥—É–ª—è

–í–æ—Ç –∫–∞–∫ –¥–æ–ª–∂–µ–Ω –≤—ã–≥–ª—è–¥–µ—Ç—å —Ñ–∞–π–ª `modules/local/my_feature.sh`:

```bash
#!/bin/bash
# ============================================================ #
# ==                 –ú–û–î–£–õ–¨ "–ú–û–Ø –§–ò–ß–ê"                      == #
# ============================================================ #
#
# MENU_PARENT: main
# MENU_ORDER: 35
# MENU_GROUP_ID: 2
# MENU_TITLE: –ú–æ—è –Ω–æ–≤–∞—è —Ñ–∏—á–∞
# MENU_KEY: x
# MENU_ENTRY: show_my_feature_menu
#
[[ "${BASH_SOURCE[0]}" == "${0}" ]] && exit 1 # –ó–∞—â–∏—Ç–∞ –æ—Ç –ø—Ä—è–º–æ–≥–æ –∑–∞–ø—É—Å–∫–∞

# === –õ–û–ö–ê–õ–¨–ù–´–ï –•–ï–õ–ü–ï–†–´ (private-—Ñ—É–Ω–∫—Ü–∏–∏) =====================

_my_feature_do_something() {
    ok "–°–¥–µ–ª–∞–Ω–æ!"
    wait_for_enter
}

_my_feature_ask_danger() {
    if ! ask_yes_no "–≠—Ç–æ –æ–ø–∞—Å–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ. –í—ã —É–≤–µ—Ä–µ–Ω—ã?"; then
        info "–û—Ç–º–µ–Ω–µ–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º."
        wait_for_enter
        return
    fi
    err "–ë–£–ú! (—à—É—Ç–∫–∞)"
    wait_for_enter
}


# === –ì–õ–ê–í–ù–û–ï –ú–ï–ù–Æ –ú–û–î–£–õ–Ø =====================================

show_my_feature_menu() {
    enable_graceful_ctrlc
    while true; do
        clear
        menu_header "üéâ –ú–æ—è –Ω–æ–≤–∞—è —Ñ–∏—á–∞"
        printf_description "–≠—Ç–æ –º–µ–Ω—é –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ —Å–æ–∑–¥–∞–Ω–∏—è –º–æ–¥—É–ª–µ–π."

        printf_menu_option "1" "–°–¥–µ–ª–∞—Ç—å —á—Ç–æ-—Ç–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ"
        printf_menu_option "2" "–°–¥–µ–ª–∞—Ç—å —á—Ç–æ-—Ç–æ –û–ü–ê–°–ù–û–ï —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º"
        printf_menu_option "b" "–ù–∞–∑–∞–¥"

        local choice
        choice=$(safe_read "–í–∞—à –≤—ã–±–æ—Ä: ") || break

        case "$choice" in
            1) _my_feature_do_something ;;
            2) _my_feature_ask_danger ;;
            [bB]) break ;;
            *) printf_error "–ù–µ—Ç —Ç–∞–∫–æ–≥–æ –ø—É–Ω–∫—Ç–∞." && sleep 1 ;;
        esac
    done
    disable_graceful_ctrlc
}
```
